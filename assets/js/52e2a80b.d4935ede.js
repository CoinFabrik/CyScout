"use strict";(self.webpackChunkcyscout=self.webpackChunkcyscout||[]).push([[306],{555:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>c});var i=n(6070),r=n(1503);const s={slug:"/"},o="CyScout",d={id:"readme",title:"CyScout",description:"Run queries and detect vulnerabilities in your smart contracts using CodeQL-Solidity",source:"@site/docs/readme.md",sourceDirName:".",slug:"/",permalink:"/CyScout/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{slug:"/"},sidebar:"tutorialSidebar",previous:{title:"LICENSE",permalink:"/CyScout/LICENSE"}},l={},c=[{value:"Run queries and detect vulnerabilities in your smart contracts using CodeQL-Solidity",id:"run-queries-and-detect-vulnerabilities-in-your-smart-contracts-using-codeql-solidity",level:2},{value:"\ud83d\udd0d Overview",id:"-overview",level:2},{value:"\ud83d\ude80 Project Status",id:"-project-status",level:2},{value:"\ud83c\udfc1 Getting Started",id:"-getting-started",level:2},{value:"Setting Up CodeQL Solidity",id:"setting-up-codeql-solidity",level:3},{value:"Install CodeQL Solidity Extension",id:"install-codeql-solidity-extension",level:3},{value:"Run Sample Detectors",id:"run-sample-detectors",level:3},{value:"Detectors",id:"detectors",level:2},{value:"Further Documentation",id:"further-documentation",level:3},{value:"Work In Progress",id:"work-in-progress",level:2},{value:"\ud83e\udd1d Contributing",id:"-contributing",level:2},{value:"License",id:"license",level:2}];function a(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"cyscout",children:"CyScout"})}),"\n",(0,i.jsx)(t.h2,{id:"run-queries-and-detect-vulnerabilities-in-your-smart-contracts-using-codeql-solidity",children:"Run queries and detect vulnerabilities in your smart contracts using CodeQL-Solidity"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:n(5730).A+"",width:"378",height:"177"})}),"\n",(0,i.jsx)(t.p,{children:"This repository contains CoinFabrik's ongoing research and development to extend CodeQL support to the Solidity smart contract language. By leveraging the foundational work done by the CodeQL team for Ruby, we have adapted and expanded their approach to create a powerful toolset for analyzing Solidity code."}),"\n",(0,i.jsx)(t.h2,{id:"-overview",children:"\ud83d\udd0d Overview"}),"\n",(0,i.jsxs)(t.p,{children:["Our goal is to provide a comprehensive set of tools for querying and detecting vulnerabilities in Solidity smart contracts. We build upon the work of ",(0,i.jsx)(t.a,{href:"https://github.com/JoranHonig/tree-sitter-solidity",children:"Joran Honig's Solidity Tree-sitter grammar"})," and the CodeQL team's ",(0,i.jsx)(t.a,{href:"https://github.blog/security/web-application-security/code-scanning-and-ruby-turning-source-code-into-a-queryable-database/",children:"Ruby implementation"}),". The project includes an extractor, database schema generation, and abstractions such as a cleaner Abstract Syntax Tree (AST), Control Flow Graph (CFG), and Dataflow analysis. These elements enable complex vulnerability detection and querying, similar to the C++ libraries in CodeQL."]}),"\n",(0,i.jsx)(t.h2,{id:"-project-status",children:"\ud83d\ude80 Project Status"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Extractor and Database Schema"}),": Usable and functional for Solidity codebases."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Current Work"}),": We are actively developing a cleaner AST, CFG, and Dataflow support to enhance the detection of vulnerabilities."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Proof of Concept (PoC)"}),": Nine simple detector examples are provided to demonstrate basic usage and potential."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"-getting-started",children:"\ud83c\udfc1 Getting Started"}),"\n",(0,i.jsx)(t.p,{children:"To get started with analyzing Solidity smart contracts using CodeQL, follow these steps:"}),"\n",(0,i.jsx)(t.h3,{id:"setting-up-codeql-solidity",children:"Setting Up CodeQL Solidity"}),"\n",(0,i.jsx)(t.p,{children:"Work in progress"}),"\n",(0,i.jsx)(t.h3,{id:"install-codeql-solidity-extension",children:"Install CodeQL Solidity Extension"}),"\n",(0,i.jsx)(t.h3,{id:"run-sample-detectors",children:"Run Sample Detectors"}),"\n",(0,i.jsx)(t.p,{children:"Once the database is created, you can run sample detectors written in the QL language:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"codeql query run /path-to-detector/ -d /path-to-created-database/\n"})}),"\n",(0,i.jsx)(t.p,{children:"For instance:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"[1/1] Found in cache: /home/user/codeql/solidity/ql/lib/detector3.ql.\ndetector3.ql: Evaluation completed (191ms).\n|      col0       |                                     col1                                     |\n+-----------------+------------------------------------------------------------------------------+\n| YulFunctionCall | /home/user/codeql/solidity-test/bitshift-order-test/vulnerable.sol@4:18:4:26 |\nShutting down query evaluator.\n"})}),"\n",(0,i.jsx)(t.h2,{id:"detectors",children:"Detectors"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Num"}),(0,i.jsx)(t.th,{children:"Detector"}),(0,i.jsx)(t.th,{children:"What it Detects"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"transfer-from"})}),(0,i.jsxs)(t.td,{children:["transferFrom uses arbitrary ",(0,i.jsx)(t.code,{children:"from"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"2"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"incorrect-shift"})}),(0,i.jsx)(t.td,{children:"incorrect order of arguments in bit shift operations"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"3"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"msg-valu-in-for-loop"})}),(0,i.jsx)(t.td,{children:"Detects the use of msg.value inside a loop"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"4"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"bad-prng"})}),(0,i.jsx)(t.td,{children:"Detects bad randomness"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"5"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"divide-before-multiply"})}),(0,i.jsx)(t.td,{children:"Detects loss of precision"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"6"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"incorrect-exp"})}),(0,i.jsx)(t.td,{children:"Detects use of bitwise xor instead of exponential"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"7"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"unchecked-send"})}),(0,i.jsx)(t.td,{children:"The return value of a send is not checked"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"8"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"is-unreachable"})}),(0,i.jsx)(t.td,{children:"Detects dead code"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"9"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"unprotected-self-destruct"})}),(0,i.jsx)(t.td,{children:"Detects unprotected call to selfdestruct/suicidal"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"further-documentation",children:"Further Documentation"}),"\n",(0,i.jsx)(t.h2,{id:"work-in-progress",children:"Work In Progress"}),"\n",(0,i.jsx)(t.p,{children:"We are actively working on enhancing the capabilities of our Solidity CodeQL implementation. Our current focus and status is on:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"AST: usable"}),"\n",(0,i.jsx)(t.li,{children:"CFG: experimental"}),"\n",(0,i.jsx)(t.li,{children:"DFA: soon"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["For more detailed instructions on using CodeQL, refer to the ",(0,i.jsx)(t.a,{href:"https://codeql.github.com/docs/",children:"official CodeQL documentation"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"-contributing",children:"\ud83e\udd1d Contributing"}),"\n",(0,i.jsx)(t.p,{children:"We welcome contributions to enhance and expand the support for Solidity in CodeQL. Feel free to submit issues, feature requests, or pull requests."}),"\n",(0,i.jsxs)(t.p,{children:["For more information, please refer to the ",(0,i.jsx)(t.a,{href:"/CyScout/Contributing",children:"Contribution Guidelines"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"license",children:"License"}),"\n",(0,i.jsxs)(t.p,{children:["The code in this repository is licensed under the ",(0,i.jsx)(t.a,{href:"/CyScout/LICENSE",children:"MIT License"})," by CoinFabrik."]}),"\n",(0,i.jsxs)(t.p,{children:["For further information on CodeQL and CodeQL CLI licensing, please refer to the official ",(0,i.jsx)(t.a,{href:"https://github.com/github/codeql-cli-binaries",children:"repo"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},5730:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/output-1649b3fc1ffdce14d0b6295e84a7b9aa.gif"},1503:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>d});var i=n(758);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);